# binspect

![a terminal window shows binspect being run against a copy of the binspect executable, searching for the string "hi". binspect returns a list of all occurrences of that string within the binary in hex format. each occurrence is placed on a new row; the 8 bytes preceding the string are printed first, followed by the offset or location of the target string, then followed by the 8 bytes starting from the target string.](img/example.png)

vibe coded [bgrep](https://github.com/tmbinc/bgrep/tree/master) with more output options

## install
needs go to build

clone to ur machine then build with `go build -o binspect main.go`


## usage
```
binspect -i <infile> -t <target-string> [options]
```
the options are:
```
  -a, --after           int     number of bytes to read after each offset (default 8)
  -A, --after-format    string  format of the bytes after: hex or char or mixed (default "hex")
  -b, --before          int     number of bytes to read before each offset (default 8)
  -B, --before-format   string  format of the bytes before: hex or char or mixed (default "hex")
  -f, --format          string  format for all columns: hex or char or mixed (default "hex")
  -i, --infile          string  path to the input file
  -O, --offset-format   string  format of the offsets: hex or decimal (default "hex")
  -o, --order           string  order of each row: any permutation of the chars 'boa' (default "boa")
  -t, --target          string  target string to search for in the input file
```
results are given in TSV format to stdout in the order `before`-`offset`-`after`. e.g:
```
$ binspect -i binspect -t "hi"
00 80 39 09 FD 63 D3 C6 0001B735        68 69 38 09 89 60 D3 EA
03 00 F9 E9 1B 40 F9 CB 00051ECD        68 69 F8 2B 07 00 F9 C8
01 07 8B 69 01 7D D3 EA 0005AC35        68 69 F8 4A 05 00 91 EA
```

## features
### column format
by default, the program will output each column in hex format:
```
$ binspect -i binspect -t "hi"
00 80 39 09 FD 63 D3 C6 0001B735        68 69 38 09 89 60 D3 EA
03 00 F9 E9 1B 40 F9 CB 00051ECD        68 69 F8 2B 07 00 F9 C8
01 07 8B 69 01 7D D3 EA 0005AC35        68 69 F8 4A 05 00 91 EA
```
you can specify the format for each column with `-B`, `-A`, `-O`:
```
$ binspect -i binspect -t "hi" -B hex -A char
00 80 39 09 FD 63 D3 C6 0001B735        hi8..`..
03 00 F9 E9 1B 40 F9 CB 00051ECD        hi.+....
01 07 8B 69 01 7D D3 EA 0005AC35        hi.J....
```
and you can specify the format for all columns with `-f` or `--format`:
```
$ binspect -i binspect -t "hi" -f char
..T.;..\n       ....    hi8.....
..T.;..\n       ....    hi8.....
......T(        ....    hi8.....
```
output mode `mixed` will give a similar result to bgrep:
```
$ binspect -i binspect -t "hi" -B mixed -A mixed
\x00\x809\x09\xFDc\xD3\xC6      0001B735        hi8\x09\x89`\xD3\xEA
\x03\x00\xF9\xE9\x1B@\xF9\xCB   00051ECD        hi\xF8+\x07\x00\xF9\xC8
\x01\x07\x8Bi\x01}\xD3\xEA      0005AC35        hi\xF8J\x05\x00\x91\xEA
```
### offset lists
a list of just the offsets can be generated by setting the before+after bytes to 0:
```
$ binspect -i binspect -t "hi" -b 0 -a 0
0001B735
00051ECD
0005AC35
```

### output order

the order of the columns can be changed by using `--order` or `-o`:
```
$ binspect -i binspect -t "hi" -order bao
00 80 39 09 FD 63 D3 C6 68 69 38 09 89 60 D3 EA0001B735
03 00 F9 E9 1B 40 F9 CB 68 69 F8 2B 07 00 F9 C800051ECD
01 07 8B 69 01 7D D3 EA 68 69 F8 4A 05 00 91 EA0005AC35
```
